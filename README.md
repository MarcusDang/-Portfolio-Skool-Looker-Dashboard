# Automated Subscription Metrics Dashboard Engine

## Overview

This project provides a robust, automated system for processing raw subscription transaction data and calculating a full suite of key performance indicators (KPIs) for a subscription-based business. It addresses the common business problem of manual, time-consuming, and error-prone data analysis by using Google Apps Script to create a powerful data pipeline within Google Sheets.

The engine reads a raw transaction log, performs complex calculations to derive 11 critical metrics—including MRR, Churn Rate, ARPU, and LTV—and outputs a clean, aggregated data source. This resulting data source is perfectly structured to be visualized in a Looker Studio (or any other BI tool) dashboard, transforming raw data into actionable business intelligence.

## Dashboard Demo

The final output populates an interactive Looker Studio dashboard, allowing for at-a-glance analysis of business health and trends over time.

*(A GIF would demonstrate interacting with the date filter and seeing all the charts and scorecards update in real-time.)*

![Dashboard Demo GIF](https://i.imgur.com/8a6P2tB.gif)

## Features

* **Automated Metric Calculation:** Calculates 11 key business metrics from a raw data source.
* **Comprehensive Analysis:** Provides insights into top-line revenue (MRR), unit economics (ARPU, LTV), and customer lifecycle (Churn, Retention, Lifespan).
* **Robust Data Pipeline:** Built with Google Apps Script, the engine handles data validation, error handling, and formatting automatically.
* **User-Friendly Interface:** A simple custom menu within Google Sheets allows any user to refresh the entire data pipeline with a single click.
* **BI Tool Ready:** The output is a clean, aggregated table perfect for connecting to Looker Studio, Tableau, or any other business intelligence platform.

## Tech Stack

* **Google Apps Script:** For the core data processing and automation logic.
* **Google Sheets:** As the data warehouse and user interface for the tool.
* **Looker Studio:** For data visualization and building the interactive dashboard.

## Setup and Usage

Follow these steps to set up and use your own copy of this project.

1.  **Make a Copy of the Google Sheet Template:**
    * **[Click here to make a copy of the Google Sheet Template](https://docs.google.com/spreadsheets/d/1_YOUR_SHEET_ID_HERE/copy)**
    * This will create a new copy of the sheet in your own Google Drive, complete with the sample data and the bound Apps Script.

2.  **Review the Data:**
    * Open the sheet and review the **`1_Raw_Data`** tab. You can use the included sample data or clear it and paste in your own data.
    * **Important:** If using your own data, ensure it matches the schema outlined below.

3.  **Grant Permissions:**
    * To use the automation, you must grant the script permission to run.
    * From the menu, click **`Dashboard Tools > Refresh Dashboard Data`**.
    * A Google Authorization prompt will appear. Follow the steps to approve the script. This only needs to be done once.

4.  **Connect to Looker Studio:**
    * The **`2_Dashboard_Source`** sheet is now ready to be used as a data source in Looker Studio.
    * For a detailed guide on building the dashboard itself, please refer to the **[Quick-Start Guide](https://example.com/path-to-your-guide)**.

## Data Schema

The script uses a two-sheet system: an input sheet for raw data and an output sheet for clean, aggregated data.

### Input Schema (`1_Raw_Data`)

This sheet requires a transaction log with the following columns:

| Column Name        | Data Type       | Description                                                  |
| ------------------ | --------------- | ------------------------------------------------------------ |
| `user_id`          | Text (String)   | A unique identifier for each member.                         |
| `transaction_date` | Date (YYYY-MM-DD) | The specific date a transaction occurred.                  |
| `transaction_amount` | Number (Currency) | The monetary value of the transaction.                     |
| `plan_name`        | Text (String)   | The name of the subscription plan.                           |
| `transaction_type` | Text (String)   | Must be either '`initial_charge`' or '`renewal`'.            |

### Output Schema (`2_Dashboard_Source`)

This is the final output, automatically generated by the script.

| Column Name                    | Data Type           | Description                                                        |
| ------------------------------ | ------------------- | ------------------------------------------------------------------ |
| `report_month`                 | Date (YYYY-MM-01)   | The first day of the month being reported.                         |
| `mrr`                          | Number (Currency)   | Monthly Recurring Revenue for the month.                           |
| `new_revenue`                  | Number (Currency)   | Portion of MRR from new members.                                   |
| `recurring_revenue`            | Number (Currency)   | Portion of MRR from existing members.                              |
| `active_members`               | Integer             | Total count of unique, paying members active during the month.     |
| `arpu`                         | Number (Currency)   | Average Revenue Per User for the month (`mrr / active_members`).     |
| `churned_members`              | Integer             | Count of members active last month but not this month.             |
| `monthly_churn_rate`           | Number (Percentage) | The percentage of members who churned this month.                  |
| `retention_rate`               | Number (Percentage) | The percentage of members retained from the previous month.        |
| `avg_member_lifespan_months`   | Number (Decimal)    | Estimated number of months a member stays subscribed.              |
| `ltv`                          | Number (Currency)   | Customer Lifetime Value, the predicted total revenue from a member. |

## Core Apps Script Logic

The script is organized into a modular and maintainable structure.

1.  **`CONFIG` Object:** A global configuration object at the top of the script holds all settings like sheet names and column indices, making the script easy to update without touching the core logic.
2.  **`onOpen()`:** A simple trigger that creates the custom "Dashboard Tools" menu in the UI for user-friendly execution.
3.  **`refreshDashboardData()`:** The main orchestrator function. It wraps the entire process in a `try...catch` block to gracefully handle errors and provide clear feedback to the user via UI alerts.
4.  **`getRawData()` & `writeMetricsToSheet()`:** These functions handle all interactions with the spreadsheet, following the best practice of reading and writing data in bulk to maximize efficiency.
5.  **`calculateDashboardMetrics()`:** This is the core engine. It uses a two-pass approach:
    * **Pass 1:** It iterates through all transactions to aggregate monthly totals (MRR, Active Users, etc.) into a `monthlyMetrics` object.
    * **Pass 2:** It then iterates through the months *chronologically* to calculate relational metrics that depend on the previous month's data, such as Churn Rate and LTV.

## Future Improvements

* **Marketing Data Integration:** Blend this data with marketing spend data (e.g., from Google Ads) to calculate Customer Acquisition Cost (CAC) and the crucial LTV:CAC ratio.
* **Leading Indicator Analysis:** Incorporate user engagement data (e.g., # of logins, posts created) from a source like Skool's API to identify leading indicators of churn.
* **Cohort Analysis:** Develop a more advanced analysis to track the retention and LTV of specific user cohorts over time (e.g., all users who joined in February 2024).
